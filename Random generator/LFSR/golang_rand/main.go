package main

import (
    "fmt"
    "math/rand"
    "math/big"
    cryptorand "crypto/rand"
)

func main() {
    var gaps [1337]int64
    var outputs [1337+32]uint64
    maxGap := big.NewInt(13)     // set to 1 for consecutive outputs

    for i := 0; i < 1337; i += 1 {
        gap, err := cryptorand.Int(cryptorand.Reader, maxGap)
        if err != nil {
            panic(err)
        }
        gaps[i] = gap.Int64()
        for j := int64(0); j < gaps[i]; j += 1 {
            rand.Uint64()
        }
        outputs[i] = rand.Uint64()
    }

    // extra outputs to verify exploit
    for i := 1337; i < 1337+32; i += 1 {
        outputs[i] = rand.Uint64()
    }

    fmt.Printf("outputs = %v\n", outputs)
    fmt.Printf("gaps = %v\n", gaps)
}